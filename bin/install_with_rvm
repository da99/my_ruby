#!/usr/bin/env bash
# -*- bash -*-
#
#
#

boot="$(pwd)"
rvm_path="$boot/rvm"
rvm="$rvm_path/bin/rvm"
ver=2.0.0

set -u -e -o pipefail

rc="$HOME/.rvmrc"

if [[ ! -f $rc ]]
then
  echo "rvm_path=$rvm_path"      >> $rc
  echo "rvm_ignore_dotfiles=yes" >> $rc
fi

if [[ ! -d $rvm_path ]]
then
  curl -L https://get.rvm.io | bash -s stable
fi

$rvm requirements
$rvm install $ver

HOME=$rvm_path rvm alias create default $ver
HOME=$rvm_path rvm alias create current $ver


if [[ "$rvm_path/rubies/current/bin/ruby" != "$(command -v ruby)" ]]
then
  echo -e "\n======================"
  echo    "Put this in your \$PATH:"
  echo    "export PATH=\"$rvm_path/rubies/current/bin:\$PATH\""
else
  export PATH="$rvm_path/rubies/current/bin:$PATH"
fi

if [[ ! -f /etc/gemrc ]]
then
  sudo cp common/_gemrc /etc/gemrc
fi

gem update --system







